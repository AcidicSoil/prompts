
> prompts@0.1.0 test
> npm run test:workflow && npm run test:jest


> prompts@0.1.0 test:workflow
> node --loader ts-node/esm scripts/__tests__/workflow_sync.test.ts

(node:53366) ExperimentalWarning: `--experimental-loader` may be removed in the future; instead use `register()`:
--import 'data:text/javascript,import { register } from "node:module"; import { pathToFileURL } from "node:url"; register("ts-node/esm", pathToFileURL("./"));'
(Use `node --trace-warnings ...` to show where the warning was created)
(node:53366) [DEP0180] DeprecationWarning: fs.Stats constructor is deprecated.
(Use `node --trace-deprecation ...` to show where the warning was created)
workflow sync regression test passed.

> prompts@0.1.0 test:jest
> NODE_OPTIONS=--experimental-vm-modules jest --runInBand

{"timestamp":"2025-09-23T16:32:02.507Z","level":"info","message":"prompt_resources_registered","metadata":{"count":6}}
{"timestamp":"2025-09-23T16:32:02.508Z","level":"info","message":"prompt_tools_registered","metadata":{"count":6}}
(node:53390) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
{"timestamp":"2025-09-23T16:32:02.511Z","level":"info","message":"workflow_tools_registered","metadata":{"count":7,"tools":["refresh_metadata","export_task_list","advance_state","workflow_run_script","workflow_run_tests","workflow_run_build","workflow_run_lint"]}}
{"timestamp":"2025-09-23T16:32:02.543Z","level":"info","message":"advance_state_recorded","metadata":{"id":"instruction-file","artifactCount":1}}
{"timestamp":"2025-09-23T16:32:02.544Z","level":"info","message":"export_task_list_completed","metadata":{"count":6}}
{"timestamp":"2025-09-23T16:32:03.720Z","level":"info","message":"refresh_metadata_completed","metadata":{"updateWorkflow":false}}
PASS test/integration/tools.test.ts
PASS test/integration/loop-execution.test.ts
PASS test/integration/run-script.live-enabled.test.ts
{"timestamp":"2025-09-23T16:32:04.244Z","level":"info","message":"prompt_resources_registered","metadata":{"count":6}}
{"timestamp":"2025-09-23T16:32:04.245Z","level":"info","message":"prompt_tools_registered","metadata":{"count":6}}
{"timestamp":"2025-09-23T16:32:04.246Z","level":"info","message":"workflow_tools_registered","metadata":{"count":8,"tools":["refresh_metadata","export_task_list","advance_state","workflow_run_script","workflow_run_tests","workflow_run_build","workflow_run_lint","workflow_run_task_action"]}}
PASS test/integration/server-advertises.test.ts
{"timestamp":"2025-09-23T16:32:04.340Z","level":"info","message":"next_task_selected","metadata":{"id":1,"title":"Initial work"}}
{"timestamp":"2025-09-23T16:32:04.341Z","level":"info","message":"list_tasks","metadata":{"count":2}}
{"timestamp":"2025-09-23T16:32:04.342Z","level":"info","message":"graph_export","metadata":{"count":2}}
{"timestamp":"2025-09-23T16:32:04.346Z","level":"info","message":"set_task_status_completed","metadata":{"id":1,"status":"pending","persisted":false}}
{"timestamp":"2025-09-23T16:32:04.350Z","level":"info","message":"set_task_status_completed","metadata":{"id":1,"status":"done","persisted":true}}
PASS test/mcp/task-tools.test.ts
{"timestamp":"2025-09-23T16:32:04.442Z","level":"info","message":"prompt_resources_registered","metadata":{"count":6}}
PASS test/integration/resources.test.ts
PASS test/integration/run-task-action.error-cases.test.ts
PASS tests/adapters/ingest.test.ts
PASS test/cli/prompts-cli.test.ts
PASS test/mcp/task-service.test.ts
PASS test/integration/agent-smoke.test.ts
PASS test/adapters/ingest.schema-path.test.ts
PASS test/mastra/prompts-tools.test.ts
PASS test/providers/factory.test.ts
PASS test/integration/run-script.error-event.test.ts
PASS test/planner/Planner.test.ts
PASS test/integration/run-script.test.ts
PASS src/tools/prompt-handler.test.ts
PASS test/state/update.test.ts
PASS test/state/StateStore.test.ts
PASS test/adapters/enrichment.test.ts
PASS test/state/graph/computeReadiness.test.ts
PASS test/state/graph/next.test.ts
PASS test/integration/run-lint.test.ts
PASS src/utils/safety.test.ts
PASS src/prompts/loader.test.ts
PASS src/prompts/schema.test.ts

Test Suites: 27 passed, 27 total
Tests:       61 passed, 61 total
Snapshots:   0 total
Time:        3.644 s, estimated 4 s
Ran all test suites.
